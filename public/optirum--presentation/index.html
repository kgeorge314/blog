<!DOCTYPE html>
<html lang="en-gb">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.30" />
    <title>optiRum – presentation</title>
    
    
    
	  <meta property="og:title" content="optiRum – presentation" />
<meta property="og:description" content="
optiRum, the R package I built and support for Optimum on CRAN has gained some extra functions recently. Some of it uses currently experimental data.table functionality so I&#8217;m eagerly awaiting the release to CRAN to deliver optiRum.

In the interim, I thought I&#8217;d give some brief overviews of existing functionality contained in the package.


The next part of the coverage of optiRum functionality is to talk about the stuff that makes generating outputs easier!

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itsalocke.com/blog/optirum--presentation/" />



<meta property="article:published_time" content="2015-06-03T15:00:31&#43;00:00"/>

<meta property="article:modified_time" content="2015-06-03T15:00:31&#43;00:00"/>













<meta itemprop="name" content="optiRum – presentation">
<meta itemprop="description" content="
optiRum, the R package I built and support for Optimum on CRAN has gained some extra functions recently. Some of it uses currently experimental data.table functionality so I&#8217;m eagerly awaiting the release to CRAN to deliver optiRum.

In the interim, I thought I&#8217;d give some brief overviews of existing functionality contained in the package.


The next part of the coverage of optiRum functionality is to talk about the stuff that makes generating outputs easier!

">


<meta itemprop="datePublished" content="2015-06-03T15:00:31&#43;00:00" />
<meta itemprop="dateModified" content="2015-06-03T15:00:31&#43;00:00" />
<meta itemprop="wordCount" content="768">



<meta itemprop="keywords" content="data visualisation,knitr,latex,optiRum,r," />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="optiRum – presentation"/>
<meta name="twitter:description" content="
optiRum, the R package I built and support for Optimum on CRAN has gained some extra functions recently. Some of it uses currently experimental data.table functionality so I&#8217;m eagerly awaiting the release to CRAN to deliver optiRum.

In the interim, I thought I&#8217;d give some brief overviews of existing functionality contained in the package.


The next part of the coverage of optiRum functionality is to talk about the stuff that makes generating outputs easier!

"/>
<meta name="twitter:site" content="@lockedata"/>

    <meta name="description" content="Locke Data helps organisations get started with data science. Grow your skills with our blog posts." />
    <meta name="keywords" content='data visualisation,knitr,latex,optiRum,r' />
    
        <meta name="author" content="Steph" />
    
    
	
    <link rel="stylesheet" href="https://itsalocke.com/blog/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://itsalocke.com/blog/css/highlightjs-themes/androidstudio.css" />
    <link rel="stylesheet" href="https://itsalocke.com/blog/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://itsalocke.com/blog/css/lockedata.css" />
    
        
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({
                    google_ad_client: "ca-pub-XXXXXX",
                    enable_page_level_ads: true
                });
            </script>
        
    
</head>

    <body>
        <!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">

    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand page-scroll" href="/blog/#page-top">
          
          <img src="https://itsalocke.com/blog/img/LockeDataTextNew.svg" class="img-responsive" alt="">
        </a>
      

    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li class="hidden">
          <a href="/blog/#page-top"></a>
        </li>
        
          <li>
            <a href="https://itsalocke.com">Locke Data</a>
          </li>
        
          <li>
            <a href="https://itsalocke.com/blog/">Blog</a>
          </li>
        

        
        
      </ul>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container-fluid -->
</nav>

        <div id="top" class="container">
            <div class="row" id="content-main">
                    <div class="row">
    <div class="col-md-12 content-card">
        <h1>optiRum – presentation</h1>
        
            
            <ul class="list-inline meta">
                <li><i class="fa fa-calendar"></i>June 3, 2015</li>
                <li><i class="fa fa-user"></i>Steph</li>
                
                    
                    <li><i class="fa fa-folder"></i><a href="https://itsalocke.com/categories/data-science">Data Science</a>, <a href="https://itsalocke.com/categories/r">R</a></li>
                
            </ul>
        
        
    <ul class="list-inline tags" style="margin-top: 15px; margin-left: 0px">
        
            <li style=""><a href="https://itsalocke.com/tags/data-visualisation">data visualisation</a></li>
        
            <li style=""><a href="https://itsalocke.com/tags/knitr">knitr</a></li>
        
            <li style=""><a href="https://itsalocke.com/tags/latex">latex</a></li>
        
            <li style=""><a href="https://itsalocke.com/tags/optirum">optiRum</a></li>
        
            <li style=""><a href="https://itsalocke.com/tags/r">r</a></li>
        
    </ul>


        <blockquote>
<p><a href="http://cran.r-project.org/web/packages/optiRum/" title="optiRum on CRAN" target="_blank">optiRum</a>, the R package I built and support for Optimum on CRAN has gained some extra functions recently. Some of it uses currently experimental data.table functionality so I&#8217;m eagerly awaiting the release to CRAN to deliver optiRum.</p>

<p>In the interim, I thought I&#8217;d give some brief overviews of <strong>existing</strong> functionality contained in the package.</p>
</blockquote>

<p>The next part of <a href="https://itsalocke.com/optirum-gini-like-a-wizard/" target="_blank">the coverage</a> of <a href="https://github.com/stephlocke/optiRum" target="_blank">optiRum</a> functionality is to talk about the stuff that makes generating outputs easier!</p>

<p></p>

<h2 id="cut2-in-latex">cut2 in LaTeX</h2>

<p>A minor thing but one that caused significant headaches is the wonderful <code>cut2()</code> function from <a href="http://cran.r-project.org/web/packages/Hmisc/index.html">Hmisc</a>. <code>cut2()</code> is a more flexible boundary generating function that produces (IMO) better intervals i.e.</p>

<ul>
<li>(0,5] is the <code>cut</code> interval and this means all numbers greater than 0 and less than or equal to 5</li>
<li>[0,5) is the <code>cut2</code> interval and this means all numbers greater than or equal to 0 and less than 5</li>
</ul>

<p>The <code>cut2</code> way ensures there are fewer allocation issues due to rounding with a large number of decimal places. Unfortunately when you try to make a table of these in LaTeX, it thinks you&#8217;re trying to go into &#8220;maths mode&#8221;.</p>

<p>To avoid this I wrote a <code>sanitise()</code> function to replace the <code>sanitize()</code> function from <a href="http://cran.r-project.org/web/packages/knitr/index.html">knitr</a> so that it will escape any <code>[</code> characters a table output from R. Whilst I was giving it a UK name (to save function masking issues), I also extended it to correctly handle the GBP symbol (<code>£</code>) since that was also an issue for us.</p>

<h2 id="charts">Charts</h2>

<p><strong>Opinion: if you&#8217;re using R, you should be using ggplot2 for charts</strong></p>

<p>Life is <em>much</em> easier when using it. Get a very quick primer in <a href="http://stephlocke.github.io/Rtraining/chartintro.html" target="_blank" title="Steph Locke explains gpplot2 basics">my note</a> about building charts using it.</p>

<p>optiRum contains a <code>theme_optimum()</code> (after the company, not an adjective) that changes the ggplot2 default chart look. The ggplot2 themes are good to begin with, and others have extended it further e.g. <a href="http://cran.r-project.org/web/packages/ggthemes/index.html">ggthemes</a>, but we wanted a standard within our company that we could use for charts. There were some considerations:</p>

<ul>
<li>colleagues love to print, despite best efforts to dissuade them, but to meet IT halfway they print 4 A4 pages per sheet (2 pages on each side) so the chart labels need to be legible when printed to less than 50% of their intended size</li>
<li>a lot of our charts are over time and colleagues like to compare values so having y-axis grid lines can aid them</li>
<li>labels whilst needing to be legible should be de-emphasised to help keep focus on the chart&#8217;s message</li>

<li><p>as much of the plot area should be given over to the chart as possible so space for legends should be minimised</p>

<figure id="attachment_61325" style="width: 1000px" class="wp-caption alignnone">[<img src="../img/optimum_adk38b.png" alt="ggplot2 example charts" width="1000" height="333" class="size-full wp-image-61325" />][4]<figcaption class="wp-caption-text">ggplot2 example charts</figcaption></figure></li>
</ul>

<p>[gist <a href="https://gist.github.com/stephlocke/fb8dd7c819aa11cc222c">https://gist.github.com/stephlocke/fb8dd7c819aa11cc222c</a> ]</p>

<h2 id="generate-pdfs">Generate PDFs</h2>

<p>Using knitr to integrate analysis and content via LaTeX is fantastic. Unfortunately, where we can end up with some pretty complex documents, we often need to make multiple passthroughs of documents to fully typeset.</p>

<p>The handy &#8220;Compile PDF&#8221; button in Rstudio, whilst great for simple documents could end up not doing enough passthroughs. At the same time it would generate lots of extra files and you&#8217;d have no control over the file name when it was generated.</p>

<p>To get around this I first used build scripts that did a lot of compensating work around the <code>knit2pdf()</code> function to do the various bits and pieces. This became relatively standard but there would be exceptions or different people would write date suffixes differently. <code>generatePDF()</code> is my answer to the various issues we encountered, including some pesky environment interactions with data.table.</p>

<p><code>generatePDF()</code> takes the following arguments (lots have defaults):</p>

<ul>
<li><code>srcpath</code> is a folder relative to the current directory so that you don&#8217;t have to change working directories</li>
<li><code>srcname</code> is the file name, less the Rnw extension, as it was easier to type plus enforced the use case</li>
<li><code>destpath</code> is the output folder, again relative to the current directory, to give better routing as we rarely wanted the PDF amongst the source code</li>
<li><code>destname</code> is the file name we want the document output as (less <code>.pdf</code>) so that we&#8217;re no reliant on the source file&#8217;s name</li>
<li><code>DATED</code> gives a date suffix to the file meaning different versions can generated over different days with unique file references (enabling the way some folks were, or provided model variants over time)</li>
<li><code>CLEANUP</code> says whether to remove all the pesky extra files that generating a PDF can produce</li>
<li><code>QUIET</code> allows you to produce a PDF with less console activity, making it less burdensome for automated tasks</li>
<li>more like environment and passthroughs to <code>knit2pdf()</code></li>
</ul>

<h2 id="get-the-package">Get the package</h2>

<ul>
<li>Install from CRAN: <code>install.packages(optiRum)</code></li>
<li>Install the dev version from the github repository using devtools: <code>devtools::install_github(&quot;stephlocke/optiRum&quot;)</code></li>
</ul>
		</div>
		
</div>
    <div class="row">
    <div class="col-md-12 card">
        <h5>Search</h5>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
            <div class="input-group">
                <input class="form-control" type="search" name="q" />
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div>
            <input type="hidden" name="q" value="site:https://itsalocke.com/blog/">
        </form>
    </div>
</div>

<div class="row">
		  <div class="col-md-12 content-card">
        
    <ul class="list-inline share" style="margin-top: 15px; margin-left: 0px">
        <li class="facebook-share"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f"><i class="fa fa-facebook fa-lg"></i>Facebook</a></li>
        <li class="googleplus-share"><a target="_blank" href="https://plus.google.com/share?url=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f"><i class="fa fa-google-plus fa-lg"></i>Google+</a></li>
        <li class="twitter-share"><a target="_blank" href="https://twitter.com/share?url=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f&amp;text=optiRum%20%e2%80%93%20presentation"><i class="fa fa-twitter fa-lg"></i>Twitter</a></li>
        <li class="reddit-share"><a target="_blank" href="http://reddit.com/submit?url=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f&amp;title=optiRum%20%e2%80%93%20presentation"><i class="fa fa-reddit fa-lg"></i>Reddit</a></li>
        <li class="linkedin-share"><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f"><i class="fa fa-linkedin fa-lg"></i>LinkedIn</a></li>
        <li class="stumbleupon-share"><a target="_blank" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fitsalocke.com%2fblog%2foptirum--presentation%2f&amp;title=optiRum%20%e2%80%93%20presentation"><i class="fa fa-stumbleupon fa-lg"></i>StumbleUpon</a></li>
    </ul>


    </div>
	</div>

                    
    
        <div class="row">
            <div class="col-md-12 content-card">
                <div id="disqus_thread"></div>
                <script>
                    (function() {
                        if (window.location.hostname == "localhost") {
                            document.write("Disqus comments are unavailable while serving on localhost or 127.0.0.1");
                            return;
                        }
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        var disqus_shortname = 'itsalocke';
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    


            </div>
        </div>
        <!-- Footer section -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <span class="copyright">
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
        </span>
      </div>
      <div class="col-md-4">
        <ul class="list-inline social-buttons">
          
            <li>
              <a href="https://twitter.com/lockedata"><i class='fa fa-twitter'></i></a>
            </li>
          
            <li>
              <a href="https://facebook.com/lockedata"><i class='fa fa-facebook'></i></a>
            </li>
          
            <li>
              <a href="https://linkedin.com/company/locke-data"><i class='fa fa-linkedin'></i></a>
            </li>
          
            <li>
              <a href="https://github.com/lockedata"><i class='fa fa-github'></i></a>
            </li>
          
        </ul>
      </div>
      <div class="col-md-4">
        <ul class="list-inline quicklinks">
          
            <li>
              <a href="/blog/index.xml">RSS</a>
            </li>
          
            <li>
              <a href="https://itsalocke.com/company/policies">Legalese and stuff</a>
            </li>
          
            <li>
              <a href="https://goo.gl/forms/KQiYR201Fcn4k9Zh2">Bug Bounty</a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>

        <div id="back-to-top" class="hidden">
    <a href="#top" class="well well-sm" onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to Top
    </a>
</div>
<script src="https://itsalocke.com/blog/js/jquery.min.js"></script>
<script src="https://itsalocke.com/blog/js/bootstrap.min.js"></script>
<script src="https://itsalocke.com/blog/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    if(($(window).height() + 100) < $(document).height()) {
        $('#back-to-top').removeClass('hidden').affix({
            offset: {
                top: 100
            }
        });
    }
</script>

    
        <script>
            
            [].forEach.call(document.querySelectorAll('.adsbygoogle'), function() {
                (adsbygoogle = window.adsbygoogle || []).push({});
            });
        </script>
    


    
 
 
 <script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-58415537-1', 'auto');


ga('require', 'eventTracker');
ga('require', 'outboundLinkTracker');
ga('require', 'urlChangeTracker');
ga('require', 'cleanUrlTracker');
ga('require', 'impressionTracker');
ga('require', 'maxScrollTracker');
ga('require', 'pageVisibilityTracker');


ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<script async src="js/autotrack.js"></script>




    </body>
</html>
