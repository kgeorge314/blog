<!DOCTYPE html>
<html lang="en-gb">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.25.1" />
    <title>Automated documentation hosting on github via Travis-CI</title>
    
    
    
    <meta name="description" content="A description that will appear as a default if front matter does not exist" />
    <meta name="keywords" content='auto deploying r documentation,best practices,continuous integration,documentation,git,github,knitr,r,rmarkdown,software development in r,tfsR,travis-ci' />
    
        <meta name="author" content="Steph" />
    
    
    <link href="" rel="alternate" type="application/rss+xml" title="Locke Data Blog" />
    <link rel="stylesheet" href="http://lockelife.com/blog/css/bootstrap.min.css" />
    <link rel="stylesheet" href="http://lockelife.com/blog/css/highlightjs-themes/androidstudio.css" />
    <link rel="stylesheet" href="http://lockelife.com/blog/css/font-awesome.min.css" />
    <link rel="stylesheet" href="http://lockelife.com/blog/css/lockedata.css" />
    
        
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({
                    google_ad_client: "ca-pub-XXXXXX",
                    enable_page_level_ads: true
                });
            </script>
        
    
</head>

    <body>
        <!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">

    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand page-scroll" href="/blog/#page-top">
          
          <img src="http://lockelife.com/blog/img/LockeDataTextNew.svg" class="img-responsive" alt="">
        </a>
      

    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li class="hidden">
          <a href="/blog/#page-top"></a>
        </li>
        
          <li>
            <a href="http://lockelife.com">Locke Data</a>
          </li>
        
          <li>
            <a href="/blog/blog/">Blog</a>
          </li>
        

        
        
      </ul>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container-fluid -->
</nav>

        <div id="top" class="container">
            <div class="row" id="content-main">
                <div class="col-md-8">
                    <div class="row">
    <div class="col-md-12 content-card">
        <h1>Automated documentation hosting on github via Travis-CI</h1>
        
            
            <ul class="list-inline meta">
                <li><i class="fa fa-calendar"></i>June 1, 2015</li>
                <li><i class="fa fa-user"></i>Steph</li>
                
                    
                    <li><i class="fa fa-folder"></i><a href="http://lockelife.com/categories/data-science">Data Science</a>, <a href="http://lockelife.com/categories/dataops">DataOps</a>, <a href="http://lockelife.com/categories/r">R</a></li>
                
            </ul>
        
        
    <ul class="list-inline share" style="margin-top: 15px; margin-left: 0px">
        <li class="facebook-share"><a target="_blank" href="http://www.facebook.com/sharer.php?u=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f"><i class="fa fa-facebook fa-lg"></i>Facebook</a></li>
        <li class="googleplus-share"><a target="_blank" href="https://plus.google.com/share?url=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f"><i class="fa fa-google-plus fa-lg"></i>Google+</a></li>
        <li class="twitter-share"><a target="_blank" href="https://twitter.com/share?url=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f&amp;text=Automated%20documentation%20hosting%20on%20github%20via%20Travis-CI"><i class="fa fa-twitter fa-lg"></i>Twitter</a></li>
        <li class="reddit-share"><a target="_blank" href="http://reddit.com/submit?url=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f&amp;title=Automated%20documentation%20hosting%20on%20github%20via%20Travis-CI"><i class="fa fa-reddit fa-lg"></i>Reddit</a></li>
        <li class="linkedin-share"><a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f"><i class="fa fa-linkedin fa-lg"></i>LinkedIn</a></li>
        <li class="stumbleupon-share"><a target="_blank" href="http://www.stumbleupon.com/submit?url=http%3a%2f%2flockelife.com%2fblog%2f2015-06-01-automated-documentation-hosting-on-github-via-travis-ci%2f&amp;title=Automated%20documentation%20hosting%20on%20github%20via%20Travis-CI"><i class="fa fa-stumbleupon fa-lg"></i>StumbleUpon</a></li>
    </ul>


        <p>In this post, I&#8217;m going to cover how you can use continuous integration and source control to build and host documentation (or any other static HTML) for free, and in a way that updates every time your code changes. I&#8217;ll cover the generic capability, and then how I apply this to my simplest package, tfsR. In a later post (once I&#8217;ve cracked the best method to do it) I&#8217;ll cover my more complex use case of multiple documents and a dynamically constructed index page.</p>

<p>NB: This is kicked off from a <a href="http://rmflight.github.io/posts/2014/11/travis_ci_gh_pages.html">post</a> from Robert Flight about applying to the technique to R package vignettes. It&#8217;s a very useful post but it was quite specific to his situation and I wanted to understand the principles behind it before I started extending it to my more complex cases.</p>

<hr />

<h3 id="posts-in-this-series">Posts in this series</h3>

<ol>
<li><a href="https://itsalocke.com/automated-documentation-hosting-on-github-via-travis-ci/">Automated documentation hosting on github via Travis-CI</a></li>
<li><a href="https://itsalocke.com/auto-deploying-documentation-multiple-r-vignettes/">Auto-deploying documentation: multiple R vignettes</a></li>
<li><a href="https://itsalocke.com/auto-deploying-documentation-faster/">Auto-deploying documentation: FASTER!</a></li>
<li><a href="https://itsalocke.com/auto-deploying-documentation-rtraining/">Auto-deploying documentation: Rtraining</a></li>
<li><a href="https://itsalocke.com/auto-deploying-documentation-better-change-tracking-artefacts/">Auto-deploying documentation: better change tracking of artefacts</a></li>
</ol>

<hr />

<h2 id="requirements">Requirements</h2>

<ul>
<li>Must haves:

<ul>
<li>Travis-CI</li>
<li>GitHub</li>
</ul></li>
<li>Optional:

<ul>
<li>A linux machine (so you can test your bash script that Travis-CI will run)</li>
<li>R (for following the specific instructions)</li>
</ul></li>
</ul>

<h2 id="high-level-process">High-level process</h2>

<ul>
<li>Get an OAUTH token from github</li>
<li>Add OAUTH token to travis</li>
<li>Add a *.sh file that gets your HTML (depending on circumstance, you may also need to generate it) and pushes to gh-pages branch</li>
<li>Include your .sh file in the <code>after_success</code> part of your travis file</li>

<li><p>Commit &amp; push!</p>

<p></p></li>
</ul>

<h2 id="detailed-process">Detailed process</h2>

<ul>
<li>Get a token from <a href="https://github.com/settings/tokens/new">github</a> &#8211; use least privileges so only grant read/write access to public repos<figure id="attachment_61354" style="width: 760px" class="wp-caption alignnone"></li>
</ul>

<p><a href="http://res.cloudinary.com/lockedata/image/upload/v1499851046/OAUTHperms_lbmohc.png"><img class="size-full wp-image-61354" src="http://res.cloudinary.com/lockedata/image/upload/v1499851046/OAUTHperms_lbmohc.png" alt="github OAUTH permissions" width="760" height="534" /></a><figcaption class="wp-caption-text">github OAUTH permissions</figcaption></figure></p>

<ul>
<li><p>Store the OAUTH token on travis with the name GH_TOKEN</p>

<ul>
<li>I did this by using the environment variables for the repository (in the settings for the repository) as it had the least dependencies required to do and travis-ci will pick up anywhere I use GH_TOKEN in the build process without me having to add it to my <code>.travis.yml</code> file</li>

<li><p>You can alternatively use the travis CLI to pass the token to travis-ci, which&#8217;ll return an encrypted version that you can use in your <code>travis.yml</code> file</p>

<figure id="attachment_61355" style="width: 765px" class="wp-caption alignnone">[<img class="size-full wp-image-61355" src="http://res.cloudinary.com/lockedata/image/upload/v1499851045/environmentvariable_y844pm.png" alt="travis-ci addd an environment variable" width="765" height="428" />][9]<figcaption class="wp-caption-text">travis-ci add an environment variable</figcaption></figure></li>
</ul></li>

<li><p>Add a bash file that gets the HTML and pushes it to the repository. <a href="http://rmflight.github.io/posts/2014/11/travis_ci_gh_pages.html">Robert&#8217;s bash script</a> is a really good example of actual code so I only cover the concept here:</p>

<ul>
<li>Create an empty directory you can work in</li>
<li>Create a git repository to hold all your HTML pages in</li>
<li>Commit all the HTML files (make sure there is one called index.html)</li>
<li>Push the repo into the gh-pages branch of your destination repo (which will be at <code>http:://[GH_TOKEN]@github.com/[CONTAINER]/[REPO].git</code>)</li>
</ul></li>

<li><p>Add your bash file to the<code>.travis.yml</code> instructions / config file so that it&#8217;ll be taken into account on the next push</p>

<h1 id="do-this-bit-if-you-encrypted-the-string-via-cli">Do this bit if you encrypted the string via CLI</h1>

<p>env:
global:</p>

<ul>
<li>secure: &ldquo;travisCLIreturnedstring&rdquo;
<br /></li>
</ul>

<h1 id="do-this-bit-for-every-situation-as-it-makes-it-executable-and-then-executes-it-once-the-build-passes-we-don-t-docs-from-bad-builds-afterall">Do this bit for every situation as it makes it executable and then executes it once the build passes - we don&rsquo;t docs from bad builds afterall!</h1>

<p>before_install:
- chmod 755 ./.push_gh_pages.sh</p>

<p>after_success:
- ./.push_gh_pages.sh</p></li>

<li><p>Commit the two (or potentially more if you need to add your bash file to build ignore files) files and then push the changes. Your next travis build should pick it all up and execute the bash file once the rest of the build has been a success</p></li>
</ul>

<h2 id="putting-it-together-8211-tfsr">Putting it together &#8211; tfsR</h2>

<p>I&#8217;ve <a href="https://itsalocke.com/easy-continuous-integration-for-r/">been using Travis-CI</a> for <a href="https://github.com/stephlocke/optiRum">optiRum</a> and <a href="https://github.com/stephlocke/tfsR">tfsR</a> for a while now. This has given me confidence in that my unit tests are run successfully, and records test coverage. What it didn&#8217;t do though was make my vignette or help documentation available &#8211; you had to read the un-rendered version of the vignette or download and compile. This wasn&#8217;t very accessible, especially for new people.</p>

<p>As this is my simplest package with only one vignette it seemed an ideal test case. To achieve the documentation building I amended or added three files, following Robert&#8217;s instructions for the most part:</p>

<h3 id="push-gh-pages-sh">.push_gh_pages.sh</h3>

<pre><code>[embedGitHubContent owner=&quot;stephlocke&quot; repo=&quot;tfsR&quot; path=&quot;.push_gh_pages.sh&quot;]
</code></pre>

<h3 id="travis-yml">.travis.yml</h3>

<pre><code>[embedGitHubContent owner=&quot;stephlocke&quot; repo=&quot;tfsR&quot; path=&quot;.travis.yml&quot;]
</code></pre>

<h3 id="rbuildignore">.Rbuildignore</h3>

<pre><code>[embedGitHubContent owner=&quot;stephlocke&quot; repo=&quot;tfsR&quot; path=&quot;.Rbuildignore&quot;]
</code></pre>

<p>You can see the finished results at <a href="http://stephlocke.github.io/tfsR">stephlocke.github.io/tfsR</a></p>

<h2 id="further-reading">Further reading</h2>

<ul>
<li><a href="http://rmflight.github.io/posts/2014/11/travis_ci_gh_pages.html">Robert Flight on Travis-CI to Github Pages</a></li>
<li><a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">Custom domains for gh-pages</a></li>
<li><a href="http://jekyllrb.com/docs/github-pages/">Jekyll github pages</a></li>
<li><a href="https://help.github.com/categories/github-pages-basics/">Github pages help</a></li>
</ul>
        
    <ul class="list-inline tags" style="margin-top: 15px; margin-left: 0px">
        
            <li style=""><a href="http://lockelife.com/tags/auto-deploying-r-documentation">auto deploying r documentation</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/best-practices">best practices</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/continuous-integration">continuous integration</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/documentation">documentation</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/git">git</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/github">github</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/knitr">knitr</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/r">r</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/rmarkdown">rmarkdown</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/software-development-in-r">software development in r</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/tfsr">tfsR</a></li>
        
            <li style=""><a href="http://lockelife.com/tags/travis-ci">travis-ci</a></li>
        
    </ul>


    </div>
</div>

                    
    
        <div class="row">
            <div class="col-md-12 content-card">
                <div id="disqus_thread"></div>
                <script>
                    (function() {
                        if (window.location.hostname == "localhost") {
                            document.write("Disqus comments are unavailable while serving on localhost or 127.0.0.1");
                            return;
                        }
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        var disqus_shortname = 'shortname';
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    


                </div>
         <div class="col-md-4">                    
	
<div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5></h5>
        <p></p>
		<img class="avatar" src="img/ChibiSteph.svg"></img>
    </div>
</div>

    <div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5>Search</h5>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
            <div class="input-group">
                <input class="form-control" type="search" name="q" />
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div>
            <input type="hidden" name="q" value="site:">
        </form>
    </div>
</div>

    

</div>
            </div>
        </div>
        <!-- Footer section -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <span class="copyright">
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
        </span>
      </div>
      <div class="col-md-4">
        <ul class="list-inline social-buttons">
          
            <li>
              <a href="/blog/#"><i class='fa fa-twitter'></i></a>
            </li>
          
            <li>
              <a href="/blog/#"><i class='fa fa-facebook'></i></a>
            </li>
          
            <li>
              <a href="/blog/#"><i class='fa fa-linkedin'></i></a>
            </li>
          
        </ul>
      </div>
      <div class="col-md-4">
        <ul class="list-inline quicklinks">
          
            <li>
              <a href="http://lockelife.com/#company">Legalise and stuff</a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>

        <div id="back-to-top" class="hidden">
    <a href="#top" class="well well-sm" onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to Top
    </a>
</div>
<script src="http://lockelife.com/blog/js/jquery.min.js"></script>
<script src="http://lockelife.com/blog/js/bootstrap.min.js"></script>
<script src="http://lockelife.com/blog/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    if(($(window).height() + 100) < $(document).height()) {
        $('#back-to-top').removeClass('hidden').affix({
            offset: {
                top: 100
            }
        });
    }
</script>

    
        <script>
            
            [].forEach.call(document.querySelectorAll('.adsbygoogle'), function() {
                (adsbygoogle = window.adsbygoogle || []).push({});
            });
        </script>
    


    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-XXXXX-YY', 'auto');
        ga('send', 'pageview');
    </script>




    </body>
</html>
